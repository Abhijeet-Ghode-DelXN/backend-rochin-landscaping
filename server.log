[33m[nodemon] 3.1.10[39m
[33m[nodemon] to restart at any time, enter `rs`[39m
[33m[nodemon] watching path(s): *.*[39m
[33m[nodemon] watching extensions: js,mjs,cjs,json[39m
[32m[nodemon] starting `node server.js`[39m
(node:12240) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:12240) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-02.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:6360) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:6360) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-00.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:3200) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:3200) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-00.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:11968) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:11968) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-02.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:3364) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:3364) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-01.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:4932) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:4932) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-02.sfnbxic.mongodb.net
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
node:internal/modules/cjs/loader:1404
  throw err;
  ^

Error: Cannot find module '../contexts/tenantContext'
Require stack:
- D:\01-07-2025\backend-rochin-landscaping\src\controllers\announcementController.js
- D:\01-07-2025\backend-rochin-landscaping\src\routes\announcements.js
- D:\01-07-2025\backend-rochin-landscaping\server.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1401:15)
    at defaultResolveImpl (node:internal/modules/cjs/loader:1057:19)
    at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1062:22)
    at Function._load (node:internal/modules/cjs/loader:1211:37)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1487:12)
    at require (node:internal/modules/helpers:135:16)
    at Object.<anonymous> (D:\01-07-2025\backend-rochin-landscaping\src\controllers\announcementController.js:4:23)
    at Module._compile (node:internal/modules/cjs/loader:1730:14) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    'D:\\01-07-2025\\backend-rochin-landscaping\\src\\controllers\\announcementController.js',
    'D:\\01-07-2025\\backend-rochin-landscaping\\src\\routes\\announcements.js',
    'D:\\01-07-2025\\backend-rochin-landscaping\\server.js'
  ]
}

Node.js v22.16.0
[31m[nodemon] app crashed - waiting for file changes before starting...[39m
[32m[nodemon] restarting due to changes...[39m
[32m[nodemon] starting `node server.js`[39m
(node:13032) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:13032) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
Server running in production mode on port 5000
MongoDB Connected: ac-q0etrwr-shard-00-02.sfnbxic.mongodb.net
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4Njc3NSwiZXhwIjoxNzU0Mjc4Nzc1fQ.FNlQnr9s_aAF4Lqx6gTpF55zAEeKhDiS8boV5T6JN0Q
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4Njc3NSwiZXhwIjoxNzU0Mjc4Nzc1fQ.FNlQnr9s_aAF4Lqx6gTpF55zAEeKhDiS8boV5T6JN0Q
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686775,
  exp: 1754278775
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4Njc3NSwiZXhwIjoxNzU0Mjc4Nzc1fQ.FNlQnr9s_aAF4Lqx6gTpF55zAEeKhDiS8boV5T6JN0Q
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4Njc3NSwiZXhwIjoxNzU0Mjc4Nzc1fQ.FNlQnr9s_aAF4Lqx6gTpF55zAEeKhDiS8boV5T6JN0Q
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686775,
  exp: 1754278775
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin', 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://isaac-gomes-ernandes.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://isaac-gomes-ernandes.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://isaac-gomes-ernandes.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://isaac-gomes-ernandes.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"3497-IB5QUFFXas0sksv0XpzA+QBS2Rg"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin', 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin', 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://isaac-gomes-ernandes.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://isaac-gomes-ernandes.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"3497-IB5QUFFXas0sksv0XpzA+QBS2Rg"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'isaac-gomes-ernandes',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://isaac-gomes-ernandes.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://isaac-gomes-ernandes.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"3497-IB5QUFFXas0sksv0XpzA+QBS2Rg"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin', 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: isaac-gomes-ernandes extracted subdomain: isaac-gomes-ernandes
Tenant Resolver: Tenant found: Isaac Gomes Ernandes new ObjectId('686371dc6afb07584c866517')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjM3MWRkNmFmYjA3NTg0Yzg2NjUxOSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDFUMDU6Mjc6NTYuOTU3WiJ9LCJfaWQiOiI2ODYzNzFkYzZhZmIwNzU4NGM4NjY1MTciLCJuYW1lIjoiSXNhYWMgR29tZXMgRXJuYW5kZXMiLCJzdWJkb21haW4iOiJpc2FhYy1nb21lcy1lcm5hbmRlcyIsIm93bmVyIjoiNjg2MzcxZGQ2YWZiMDc1ODRjODY2NTE5IiwiY3JlYXRlZEF0IjoiMjAyNS0wNy0wMVQwNToyNzo1Ni45NjFaIiwiX192IjowLCJlbWFpbCI6InRlc3RAZ21haWwuY29tIiwiYWRkcmVzcyI6Ijg4OTMgZWFzdCA4dGggc3QgLCBwaG9lbml4IEFyaXpvbmEiLCJwaG9uZSI6IisxICg2MDIpIDQyMS00NTk2In0sImlhdCI6MTc1MTY4NzA4MCwiZXhwIjoxNzU0Mjc5MDgwfQ.rPqEFPuSO6NL5isbjK5NU1ktRxOVq_0Dau8q9CRyUgs
Verifying token with secret: Secret exists
Decoded token: {
  id: '686371dd6afb07584c866519',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-01T05:27:56.957Z'
    },
    _id: '686371dc6afb07584c866517',
    name: 'Isaac Gomes Ernandes',
    subdomain: 'isaac-gomes-ernandes',
    owner: '686371dd6afb07584c866519',
    createdAt: '2025-07-01T05:27:56.961Z',
    __v: 0,
    email: 'test@gmail.com',
    address: '8893 east 8th st , phoenix Arizona',
    phone: '+1 (602) 421-4596'
  },
  iat: 1751687080,
  exp: 1754279080
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:97:15
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: Access denied: User does not belong to this tenant
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:96:17
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'admin' ] }
Role not authorized: tenantAdmin
--- GLOBAL ERROR HANDLER ---
ErrorResponse: User role tenantAdmin is not authorized to access this route
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:122:9
    at Layer.handle [as handle_request] (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:328:13)
    at D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:346:12)
    at next (D:\01-07-2025\backend-rochin-landscaping\node_modules\express\lib\router\index.js:280:10)
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\tenantResolver.js:99:3
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\async.js:3:5
    at D:\01-07-2025\backend-rochin-landscaping\src\middlewares\auth.js:54:13
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5) {
  statusCode: 403
}
--- END GLOBAL ERROR HANDLER ---
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Appointments Route - Headers: {
  host: 'localhost:5000',
  connection: 'keep-alive',
  'x-tenant-subdomain': 'gildardo-rochin',
  'sec-ch-ua-platform': '"Windows"',
  authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36',
  accept: 'application/json, text/plain, */*',
  'sec-ch-ua': '"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',
  'sec-ch-ua-mobile': '?0',
  origin: 'http://gildardo-rochin.localhost:3000',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  referer: 'http://gildardo-rochin.localhost:3000/',
  'accept-encoding': 'gzip, deflate, br, zstd',
  'accept-language': 'en-US,en;q=0.9',
  'if-none-match': 'W/"27d9-6F7Po3mXDZJpnQAQWJ5yzab6+/c"'
}
Appointments Route - Method: GET
Appointments Route - Path: /
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: {
  userRole: 'tenantAdmin',
  allowedRoles: [ 'tenantAdmin', 'professional' ]
}
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Checking role authorization: { userRole: 'tenantAdmin', allowedRoles: [ 'tenantAdmin' ] }
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Auth Headers: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Token from Authorization header: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4NjQ5NTlkY2FjOTAzMDJlOTM5YTQxNSIsInJvbGUiOiJ0ZW5hbnRBZG1pbiIsInRlbmFudElkIjp7InNldHRpbmdzIjp7InRpbWV6b25lIjoiVVRDIn0sInN1YnNjcmlwdGlvbiI6eyJwbGFuIjoibW9udGhseSIsInN0YXR1cyI6ImFjdGl2ZSIsInN0YXJ0RGF0ZSI6IjIwMjUtMDctMDJUMDI6MTI6NDUuMzY4WiJ9LCJfaWQiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTMiLCJuYW1lIjoiR2lsZGFyZG8gUm9jaGluIiwic3ViZG9tYWluIjoiZ2lsZGFyZG8tcm9jaGluIiwib3duZXIiOiI2ODY0OTU5ZGNhYzkwMzAyZTkzOWE0MTUiLCJjcmVhdGVkQXQiOiIyMDI1LTA3LTAyVDAyOjEyOjQ1LjM3MVoiLCJfX3YiOjAsImVtYWlsIjoiZ3JvY2hpbjJAZ21haWwuY29tIiwiYWRkcmVzcyI6IiIsInBob25lIjoiIn0sImlhdCI6MTc1MTY4NjkyNiwiZXhwIjoxNzU0Mjc4OTI2fQ.C2tATiZUmqDADGuCWpsTK9J7MRPtHZN_dsCOr4-jukc
Verifying token with secret: Secret exists
Decoded token: {
  id: '6864959dcac90302e939a415',
  role: 'tenantAdmin',
  tenantId: {
    settings: { timezone: 'UTC' },
    subscription: {
      plan: 'monthly',
      status: 'active',
      startDate: '2025-07-02T02:12:45.368Z'
    },
    _id: '6864959dcac90302e939a413',
    name: 'Gildardo Rochin',
    subdomain: 'gildardo-rochin',
    owner: '6864959dcac90302e939a415',
    createdAt: '2025-07-02T02:12:45.371Z',
    __v: 0,
    email: 'grochin2@gmail.com',
    address: '',
    phone: ''
  },
  iat: 1751686926,
  exp: 1754278926
}
Found user: Yes
User role: tenantAdmin
Token role: tenantAdmin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
Tenant Resolver: headerSubdomain: gildardo-rochin extracted subdomain: gildardo-rochin
Tenant Resolver: Tenant found: Gildardo Rochin new ObjectId('6864959dcac90302e939a413')
No token found, continuing as unauthenticated
